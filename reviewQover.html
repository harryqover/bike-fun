<html>
	<head>
		<script>
			function getParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=new RegExp("[\\?\x26]"+a+"\x3d([^\x26#]*)");a=a.exec(location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))}
		</script>
		<style>
			@import url('https://fonts.googleapis.com/css2?family=Albert+Sans&display=swap');
			.lds-default{display:inline-block;position:relative;width:80px;height:80px}.lds-default div{position:absolute;width:6px;height:6px;background:white;border-radius:50%;animation:1.2s linear infinite lds-default}.lds-default div:first-child{animation-delay:0s;top:37px;left:66px}.lds-default div:nth-child(2){animation-delay:-.1s;top:22px;left:62px}.lds-default div:nth-child(3){animation-delay:-.2s;top:11px;left:52px}.lds-default div:nth-child(4){animation-delay:-.3s;top:7px;left:37px}.lds-default div:nth-child(5){animation-delay:-.4s;top:11px;left:22px}.lds-default div:nth-child(6){animation-delay:-.5s;top:22px;left:11px}.lds-default div:nth-child(7){animation-delay:-.6s;top:37px;left:7px}.lds-default div:nth-child(8){animation-delay:-.7s;top:52px;left:11px}.lds-default div:nth-child(9){animation-delay:-.8s;top:62px;left:22px}.lds-default div:nth-child(10){animation-delay:-.9s;top:66px;left:37px}.lds-default div:nth-child(11){animation-delay:-1s;top:62px;left:52px}.lds-default div:nth-child(12){animation-delay:-1.1s;top:52px;left:62px}@keyframes lds-default{0%,100%,20%,80%{transform:scale(1)}50%{transform:scale(1.5)}}
			body{
			    background-color: #3e6ae1;
			    background-image: radial-gradient(circle farthest-side at 0 0,#5c85f1,#234ec2);
			    flex-direction: column;
			    justify-content: center;
			    align-items: center;
			    display: flex;
			    position: fixed;
			    top: 0%;
			    bottom: 0%;
			    left: 0%;
			    right: 0%;
			    font-family: Albert Sans,sans-serif;
			}
			h1{
				color: #fff;
			    text-align: center;
			    margin-left: 40px;
			    margin-right: 40px;
			    font-size: 64px;
			    line-height: 68px;
			    filter: blur(5px);
			    transform: scale(0.5); /* initial scale */
				opacity: 0; /* initial opacity */
				transition: all 1s ease-out; /* transition effect */
			}
			h2{
				color: #fff;
			    text-align: center;
			    font-weight: 400;
				margin-top: 20px;
			    font-size: 24px;
			    line-height: 30px;
			    transform: translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);
			    opacity: 1;
			    filter: blur(0px);
			    transform-style: preserve-3d;
			    filter: blur(5px);
			    transform: scale(0.5); /* initial scale */
				opacity: 0; /* initial opacity */
				transition: all 1s ease-out; /* transition effect */
			}
		</style>
	</head>
	<body>
		<h1>Thanks</h1>
		<h2></h2>
		<div class="lds-default"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>
		<script>
			var originalRating = getParameterByName("r");
			var rating = originalRating;
			var zendeskId = getParameterByName("z");
			var cigarId = getParameterByName("c");
			var source = getParameterByName("s");
			var lang = getParameterByName("l");
			lang = lang.toLowerCase();
			var product = getParameterByName("product");
			var partner = getParameterByName("partner");
			var country = getParameterByName("country");
			var minPublicRating = 3;
			const h1 = document.querySelector('h1');
			const h2 = document.querySelector('h2');

			if(source == "emailClaimNPS" && rating > 0){
				rating = rating /2;
			}


			console.warn(rating);

		    var googleSheetUrl = "https://script.google.com/macros/s/AKfycbyzxKUaL5DCzI3ND_9j4WgLW0-8eXH3wDG276jZD7wbwhTY8ut2FRIMTrkeHUQQOceD/exec";

			var xhr = new XMLHttpRequest();
			xhr.open("POST", googleSheetUrl, true);
			xhr.setRequestHeader("Content-Type", "text/plain;charset=utf-8");
			xhr.timeout = 0;
			xhr.onreadystatechange = function() {
				if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
					console.log(this.responseText);

				    if (rating > minPublicRating) {
				    	//var redirectUrls = ["https://www.trustpilot.com/evaluate/qover.com", "https://g.page/r/CeJV3VPdzwkCEAI/review"];
				    	var redirectUrls = ["https://www.trustpilot.com/evaluate/qover.com", "https://www.trustpilot.com/evaluate/qover.com"];
						var randomIndex = Math.floor(Math.random() * redirectUrls.length);
						window.location.replace(redirectUrls[randomIndex]);
					  	//window.location.replace("https://www.trustpilot.com/evaluate/qover.com");
					} else {
						var ref = ((cigarId)?cigarId:zendeskId);
						window.location.replace("https://forms.qover.com/221674111787054?contractReference="+ref+"&language="+lang);
					}
			    }
			};
			xhr.send(JSON.stringify({ cigarId: cigarId, rating: originalRating, zendeskId: zendeskId, source: source, product: product, partner: partner, country: country }));
			const translationH1 = {
				"fr": "Merci!",
				"en": "Thanks for your feedback!",
				"es": "Thanks for your feedback!",
				"nl": "Bedankt voor je feedback!",
				"de": "Vielen Dank für Ihr Feedback!",
				"it": "Thanks for your feedback!",
				"pt": "Thanks for your feedback!"
			}
			const textH1 = translationH1[lang];

			const translationH2Positive = {
				"fr": "Nous serions ravis que vous puissiez partager votre expérience positive avec d'autres clients.",
				"en": "We would be over the moon if you could share your positive experience with other customers.",
				"es": "We would be over the moon if you could share your positive experience with other customers.",
				"nl": "We would be over the moon if you could share your positive experience with other customers.",
				"de": "We would be over the moon if you could share your positive experience with other customers.",
				"it": "We would be over the moon if you could share your positive experience with other customers.",
				"pt": "We would be over the moon if you could share your positive experience with other customers."
			}
			const textH2Positive = translationH2Positive[lang];

			const translationH2Negative = {
				"fr": "Nous serions ravis d'obtenir de plus amples informations.",
				"en": "We would love to get more information.",
				"es": "We would love to get more information.",
				"nl": "We would love to get more information.",
				"de": "We would love to get more information.",
				"it": "We would love to get more information.",
				"pt": "We would love to get more information."
			}
			const textH2Negative = translationH2Negative[lang];

			if (rating > minPublicRating) {
				h1.textContent = textH1;
				h2.textContent = textH2Positive;
			} else {
				h1.textContent = textH1;
				h2.textContent = textH2Negative;
			}
			h1.style.filter = 'blur(0)';
		    h1.style.transform = 'scale(1)';
		    h1.style.opacity = 1;
			setTimeout(function() {
			    h2.style.filter = 'blur(0)';
			    h2.style.transform = 'scale(1)';
		    	h2.style.opacity = 1;
			  }, 500);

			console.log("https://harryqover.github.io/bike-fun/reviewQover?r=8&z=56788&c=BE109817398&s=emailClaimNPS&l=FR");
		</script>
	</body>
</html>